<template name="App_body">
  {{#HammerTouchArea gestureMap=templateGestures}}
  <div id="container">
    <div class="navbar-fixed-top {{sideNavOpen}}">
      <div id="mobile-nav-holder">
        <a href="#" id="hamburger-menu">
          <i class="fa fa-bars" aria-hidden="true"></i>
        </a>
      </div>
      <div class="logo-holder">
        <a href="/" class="logoLink"></a>
      </div>

      <div class="main-nav-holder">
        <nav class="main-nav">
          <ul class="main-nav-ul">
            <li><a href="/" class="{{currentPage 'App.home'}}" alt="Home">Home</a></li>
            <li><a href="/menu" class="{{currentPage 'Menu.show'}}" alt="Menu">Menu</a></li>
            {{#if notSubscribed}}
              <li><a href="/subscribe" class="{{currentPage 'Subscribe'}}" alt="Subscribe">Subscribe</a></li>
            {{/if}}
            <li><a href="/packs" class="{{currentPage 'Packs'}}" alt="Packs">Packs</a></li>
            <!-- <li><a href="/market" class="{{currentPage 'Market'}}" alt="Market">Market</a></li> -->
            <li><a href="/gifts" class="{{currentPage 'Gifts'}} new" alt="Gifts">Gifts</a></li>
            <li><a href="/about-us" class="{{currentPage 'About.us'}}" alt="About">About Us</a></li>
            <li><a href="/support" class="{{currentPage 'Support'}}" alt="Support">Support</a></li>
          </ul>
        </nav>
      </div>

      <div id="notifications-holder">
        {{#if currentUser}}
          {{#if firstName}}
            <div class="welcome">
              <p>{{firstName}}</p>
              {{#if userMenuOpen}}
                <i class="fa fa-caret-up"></i>
              {{else}}
                <i class="fa fa-caret-down"></i>
              {{/if}}    
            </div>
          {{else}}
            <div class="welcome">
              <p>{{emailLocalPart}}</p>
              {{#if userMenuOpen}}
                <i class="fa fa-caret-up"></i>
              {{else}}
                <i class="fa fa-caret-down"></i>
              {{/if}}
            </div>
          {{/if}}
          <a id="notifications">
            <i class="fa fa-bell-o"></i>
          </a>
          <div id="credit"></div>
        {{else}}
          <div class="sign-in">
            <a href="{{pathFor 'signin'}}">Sign In</a>
          </div>
        {{/if}}
      </div>
      {{#if userMenuOpen}}
        <div id="userMenu">
          <a class="btn-primary" href="/my-account">Settings</a>
          <a class="js-logout btn-primary">Logout</a>
        </div>
      {{/if}}  
    </div>

    <div class="content-overlay {{sideNavOpen}} {{packEditorOpen}} {{loading}} {{closed}} {{capped}}">
      {{#if closed}}
        {{#momentum plugin="fade"}}
          <div id="closed">
            <p>Custom packs are available Sunday at Noon<br>until Wednesday at Midnight each week.<br>
            <a href="/packs">Check out our premade packs!<br><br>CLICK HERE TO VIEW</a></p>
          </div>
        {{/momentum}}
      {{/if}}

      {{#if capped}}
        {{#momentum plugin="fade"}}
          <div id="capped">
            <!-- <span>x</span> -->
            <h2>Sorry, we're at our capacity for this week!</h2>
            <p>To maintain the highest quality production, and to best serve our subscribers, we're capping our orders for next week's delivery.</p>
            <br>
            <a href="/subscribe">Subscribe today</a>
            <p>to secure your order for the week of December 17th.</p>
            <p>Or if you're a subscriber, <a href="/signin">Sign In</a></p>
          </div>
        {{/momentum}}
      {{/if}}

      {{#if loading}}
        {{> loader}}
      {{/if}}
    </div>

    <div id="content-container" class="{{closed}}">
      {{#momentum plugin="fade"}}
        {{#if Template.subscriptionsReady}}
          {{> Template.dynamic template=main}}
        {{else}}
          {{> App_loading}}
        {{/if}}
      {{/momentum}}
    </div>
    {{#if packEditorOpen}}
      {{#momentum plugin="fade"}}
        {{> Cart}}
      {{/momentum}}
    {{/if}}
  </div>
  {{> Side_Nav}}
  {{> sAlert}}
  {{/HammerTouchArea}}
</template>
